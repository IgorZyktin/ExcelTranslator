# ExcelTranslator

Простой транслятор excel-подобного языка в код на python

### Пример

Код на входе:
```
num = СЛЧИС() * 10;
ЕСЛИ (num >= 9)
{
    x = ">= 9";
}
ИНАЧЕ_ЕСЛИ (num >= 8) 
{
    x = ">= 8";
} 
ИНАЧЕ_ЕСЛИ (num >= 7) 
{
    x = ">= 7";
} 
ИНАЧЕ_ЕСЛИ (num >= 6) 
{
    x = ">= 6";
} 
ИНАЧЕ_ЕСЛИ (num >= 5) 
{
    x = ">= 5";
} 
ИНАЧЕ_ЕСЛИ (num >= 4) 
{
    x = ">= 4";
} 
ИНАЧЕ_ЕСЛИ (num >= 3) 
{
    x = ">= 3";
} 
ИНАЧЕ_ЕСЛИ (num >= 2) 
{
    x = ">= 2";
} 
ИНАЧЕ 
{
    x = "около 1";
};
```

Код на выходе:
```
num = random.random() * 10
if num >= 9:
    x = ">= 9"

elif num >= 8:
    x = ">= 8"

elif num >= 7:
    x = ">= 7"

elif num >= 6:
    x = ">= 6"

elif num >= 5:
    x = ">= 5"

elif num >= 4:
    x = ">= 4"

elif num >= 3:
    x = ">= 3"

elif num >= 2:
    x = ">= 2"

else:
    x = "около 1"
```

Полученное синтаксическое дерево:
```
Инструкция
        ├─────Присваивание
        │     ├─────Имя(num)
        │     └─────Умножить
        │           ├─────Вызов
        │           │     └─────Имя(СЛЧИС)
        │           └─────10
        └─────Условие
              ├─────if
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────9
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 9"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────8
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 8"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────7
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 7"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────6
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 6"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────5
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 5"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────4
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 4"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────3
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 3"
              ├─────elif
              │     ├─────Больше или равно
              │     │     ├─────Имя(num)
              │     │     └─────2
              │     └─────Фигурные скобки
              │           └─────Инструкция
              │                 └─────Присваивание
              │                       ├─────Имя(x)
              │                       └─────">= 2"
              └─────else
                    └─────Фигурные скобки
                          └─────Инструкция
                                └─────Присваивание
                                      ├─────Имя(x)
                                      └─────"около 1"
```

### Типы данных

- Числа - все являются вещественными, округляются до 5 знаков после запятой.
- Строки - все должны быть заключены в двойные кавычки: "".
- null - для пустого объекта.

Отдельных логических типов не предусмотрено. Вместо них используется 1 и 0.
Тип переменной определяется автоматически, но изменяться после создания уже не может.

### Типы операторов

Приоритет 0:
    
    ** Возведение в степень.

Приоритет 1:
    
    - Унарный минус.
    
Приоритет 2:

    * Умножение.
    / Деление.

Приоритет 3:    
    
    + Сложение.
    - Вычитание.
    
Приоритет 4:

    > Больше.
    < Меньше.
    >= Больше или равно.
    <= Меньше или равно.

Приоритет 5:
    
    == Равно.
    != Не равно.

Приоритет 6:

    И Истинно если оба операнда истинны.
    ИЛИ Истинно если хоть один из операндов истинен.
    
Приоритет 7:
    
    НЕ Логическое отрицание.
    
Приоритет 8:
    
    = Присвоить значение переменной.

Приоритет 9:

    ; Разграничение операций.

#### Условия

Одиночное:
    
    ЕСЛИ(){}

Двойное:

    ЕСЛИ(){} ИНАЧЕ {}
    
Множественное без финального выражения:

    ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){}
    
Множественное:

    ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ_ЕСЛИ(){} ИНАЧЕ{}
    
Условия можно вкладывать друг в друга. 
Специально проверять значения не требуется, но константы
ИСТИНА и ЛОЖЬ имеются (они равны соответственно 1 и 0).
При желании можно в качестве ключевых слов использовать if, elif, else.

### Математические функции

|Формат вызова     |Результат                                     |
|------------------|----------------------------------------------|
|СЛЧИС()           |Случайное число от 0.0 до 1.0                 |
|МИН(1, 2)         |Минимум из аргументов                         |
|МАКС(1, 2)        |Максимум из аргументов                        |
|СУММ(1, 2)        |Сумма аргументов                              |
|ABS(-6)           |Значение по модулю                            |
|ОКРУГЛ(2.75), ОКРУГЛ(2.75, 0)|Округлить число                    |
|ОКРВВЕРХ(2.75)    |Округлить до ближайшего большего целого       |
|ОКРВНИЗ(2.75)     |Округлить до ближайшего меньшего целого       |
|ОСТАТ(4, 3)       |Остаток от деления                            |
|СЛУЧМЕЖДУ(14, 32) |Случайное целое число между двух целых чисел  |
|КОРЕНЬ(2)         |Квадратный корень                             |
|ОТБР(2.75)        |Привести к целому, отбросив дробную часть     |
|СРЗНАЧ(1, 2, 3)   |Среднее из аргументов                         |

### Текстовые функции

|Формат вызова           |Результат                                     |
|------------------------|----------------------------------------------|
| СТРОЧН("ТЕКСТ")        |Привести регистр букв к строчным              |
| ПРОПИСН("текст")       |Привести регистр букв к ПРОПИСНЫМ             |
| ТЕКСТ(74)              |Преобразовать число в текст                   |
| ЗНАЧЕН("74")           |Преобразовать текст в число                   |
| СЦЕПИТЬ(1, 2)          |Соединить аргументы в строку                  |
| ОБЪЕДИНИТЬ(" + ", 1, 2)|Соединить аргументы в строку, использовав первый аргумент как разделитель |

            
### Логические функции

|Формат вызова     |Результат                                     |
|------------------|----------------------------------------------|
| ВСЕ_ИЗ(x, y)     |ИСТИНА если все аргументы истинны             |
| ОДИН_ИЗ(x, y)    |ИСТИНА если хоть один аргумент истинен        |
| НИ_ОДИН_ИЗ(x, y) |ИСТИНА если все аргументы ложны               |
                        
#### В языке нет таких возможностей, как

* Создание сущности сложнее строк и чисел.
* Создание циклов.
* Создание своих функции.
* Областей видимости (все переменные глобальны).
